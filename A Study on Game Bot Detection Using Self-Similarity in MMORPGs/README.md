# A Study on Game Bot Detection Using Self-Similarity in MMORPGs
# 자기 유사도를 이용한 MMORPG 게임봇 탐지 시스템 - 이은조, 조원준, 김현철, 엄혜민, 이지나, 권혁민, 김휘강 ,정보보호학회논문지(2016)
- 설정된 패턴에 따라 행동을 반복하는 자기유사성을 주요 특질로 이용한 기계 학습 기법을 제안하고 이렇게 학습한 모델을 자동으로 유지 보수하는 
시스템을 제안 -> 엔씨소프트의 대표 MMORPG인 리니지, 아이온, 블레이드 앤 소울에대해 성능을 테스트하였으며 시스템을 구현하여 실전에 적용

- 다중 접속 역할 게임(이하 MMORPG)에는 자동 사냥 프로그램을 사용하여 부정한 방법으로 게임을 플레이하는 유저(이하 게임 봇)가 존재
- 게임 봇을 탐지하기 위해 보통 게임 회사에서는 게임 운영자나 데이터 분석가가 게임 봇을 사용하는 유저들의 플레이 특징을 찾거나 혹은 게임 봇 프로그
램 역공학을 통해 프로세스 패턴을 찾아 이를 탐지 규칙으로 적용하는 방법을 많이 사용한다.
  - 개별적인 탐지 규칙을 만들어야 하는 부담
    - 데이터 마이닝은 이렇게 탐지 규칙을 만드는데 드는 비용을 완화하는데 도움이 됨 
    - 각 게임 유저가 플레이한 상세 이력이 담겨 있는 로그 데이터를 이용해 게임 봇과 일반유저를 구분할 수 있는 분류 모델을 학습하여 탐지에 사용하
는 것

- 첫째, 게임 봇이 갖고 있는 근본적인 속성 중 자기 유사성에 주목하고 이를 특질로 이용
- 둘째, 우리는 탐지 결과가 더 이상 유효하지 않게 되는 시점을 자동으로 탐지하고 모델 재학습을 통해 변경된 상황에 맞는 탐지 모델을 자동 생성하는 프로세스를 제안

## Related Works
- 게임 봇을 gatherer, banker, dealer, marketer 로 유형화했으며 탐지 모델에 사용할 특질로 demographic data, sequence data, 
statistical activity, economic transaction, network centrality 등 다양한 데이터를 사용
- MMORPG에서 캐릭터 간에 주고받는 채팅 데이터에 주목하여 게임 봇과 일반 유저를 분류하는 기법을 제시
- 파티 플레이 특징을 이용한 봇 탐지 기법을 제안
- 다양한 게임 로그를 이용해 각 캐릭터들을 행동이 유사한 그룹별로 군집화하고 각 그룹에 대해 별도의 탐지 모델을 적용하는 기법을 제안
  - 기존 탐지 기법에 비해 좀 더 정교하고 일반적인 탐지를 수행 가능 
  - 각 유형별로 학습 집합을 생성해야하기 때문에 탐지 모델 생성에 높은 비용이 든다. 또한 게임 컨텐츠 업데이트로 인해 플레이 패턴이 바뀌면 행동 유형을 다시 군집화하고 학습 집합을 
생성해야 하는 부담
- 이동 경로를 이용한 탐지 기법을 제안
-  자기 유사도 알고리즘은 MMORPG 내에서 수행 가능한 캐릭터의 모든 행동을 대상으로 삼았기 때문에 상대적으로 우회 패턴을 만들기 어려워 견고하다는 장점

## sol
- 과거에 게임 봇을 사용하여 제재를 당한 계정 목록을 입수했다. 그리고 이 계정들과 일반 계정의 게임 로그 데이터를 이용해서 이 두 집단 간의 차이를 비교 분석
- 게임 로그는 유저들이 사냥, 채집, 아이템 거래, 게임 접속 및 종료 등의 행동을 수행하거나 특정 이벤트가 발생할 때마다 게임 서버에 기록
-  각각의 이벤트나 행동은 그 종류에 따라 고유 아이디 -> 로그 아이디
  - 유저별로 이 로그 아이디의 리스트를 시퀀스 데이터로 생성했다. 그리고 이 전체 시퀀스를 일정 개수 단위로 이동해가며 부분 집합 시퀀스를 만들었다
  ![image](https://user-images.githubusercontent.com/47103479/146016740-913ac1bf-faf6-46b3-95dd-9d7fe94f5bb9.png)

  - 전체 유저는 시퀀스 총 개수 대비 시퀀스 종류 수의 비율에 따라 크게 2개 집단을 형성하고 있는데 대부분의 제재 계정은 시퀀스 개수 대비 종류 수의 비율이 낮은 쪽 집단에 포함되어 있다. 이것은 제재 유저들이 일반 유저에 비해 특정 행동을 반복적으로 수행하는 것을 의미
  ![image](https://user-images.githubusercontent.com/47103479/146016995-b0cbff71-4583-4d12-ab39-410ec94285eb.png)

- 한계점
  - 전체 게임 유저에 대해서 시퀀스 데이터를 생성하는 것은 시스템 처리 비용이 큰 작업이다. 예를 들어 각 유저별로 N개의 게임 로그 데이터가 있을 경우 이것을 k개씩 묶음으로 시퀀스 데이터를 생성하기 위해  ×   
만큼의 데이터를 생성해야 한다. 또한 데이터를 시간 순으로 정렬

- 시퀀스 대신 벡터를 이용하여 분석을 진행
  - 게임 로그를 특정 시간 단위로 묶어서 벡터를 생성한 후 각각의 벡터가 서로 얼마나 유사한지 측정하기 위해 각각의 벡터와 단위 벡터(벡터의 크기가 1인 벡터)간의 코사인 유사도를 측정
  - 특정 유저가 비슷한 행동(시퀀스)를 반복한다면 유사한 벡터가 반복해서 생성될 것이고 결국 단위 벡터와 계산된 각각의 코사인 유사도 역시 비슷한 값이 반복적으로 생성될 것
![image](https://user-images.githubusercontent.com/47103479/146017087-d5ae0369-ade7-4e59-a6a6-f83e04135532.png)

  -  일반 유저는 시간의 흐름에 따라 코사인 유사도 값의 변화가 큰 반면 게임 봇은 일부 구간을 제외하고는 대체로 비슷한 값을 유지한다
  -  이 코사인 유사도 값들을 이용해 자기 유사도를 측정-> 우리가 실험한 세 개 게임 모두 게임 봇이 일반 유저에 비해 자기 유사도가 높은 경
향을 보인다
  ![image](https://user-images.githubusercontent.com/47103479/146017337-a891c948-3c3e-4585-bf44-5c55325f87a8.png)
  
  - 개선포인트
    - 벡터 생성 시 로그의 정렬이 필요 없고 단지 유저별 시간별 분류 후 로그 아이디별 발생 개수를 세는 작업만 필요하기 때문에 시퀀스데이터에 비해 계산 비용 및 결과 데이터 크기가 훨
씬 작다.
    ![image](https://user-images.githubusercontent.com/47103479/146017527-7f672878-116c-44a6-9f61-17a6feff9010.png)

## Methodology
- Feature selection
  - 로그 벡터 생성
    - 서버에서 수집된 게임 로그를 각 캐릭터별로 분류하고 시간 순으로 정렬 -> 이후 분류된 로그를 다시 일정 시간 단위로 묶는다. 이렇게 묶인 로그에 대해서 로그 벡터를 생성하는데, 벡터의 차원은 해당 게임에서 나올 수 있는 전체 로그 아이디가 되며 각 차원의 값은 해당 차원의 로그 아이디가 해당 시간대에 발생한 횟수
  - 로그 벡터와 단위 벡터 간 코사인 유사도 측정
  ![image](https://user-images.githubusercontent.com/47103479/146017790-6ca050bc-fca7-4f02-8bce-c002748b2991.png)

  - 코사인 유사도의 표준 편차 측정
  - 추가 특질 적용 -> 캐릭터가 아무런 행동을 하지 않고 장시간 대기하고 있거나 혹은 극히 짧은 시간만 플레이하는 경우 자기 유사도가 높게 나오는 문제
  ![image](https://user-images.githubusercontent.com/47103479/146018009-98f4ecf1-11e4-4f11-aa62-bec40d5c9005.png)

- 탐지 모델 생성 및 평가
  - 로지스틱 회귀 모델
    -  K-fold cross validation을 이용해 탐지 모델의 성능을 평가
    -  검증 시에는 Receiver Operating Characteristic (ROC) 곡선에 대한 면적(Area Under the Curve, AUC)을 구하여 성능을 측정
한다

- 결과 모니터링 및 탐지 모델 재학습
![image](https://user-images.githubusercontent.com/47103479/146018390-550ed119-fb6e-4172-a706-459049b017ed.png)

  - 변화 감지(Change detected)' 단계에서 EWMA 라는 기법
    - 게임봇 확률 상관 계수 계산
    - 상관 계수 변화량 계산
    - 관리 한계치 측정 및 비교
    -  모델 검증

## Experiments
- 정답 집합 구축
  - 게임 봇 탐지 모델을 구축하기 위해선 학습 및 검증에 필요한 정답 집합(ground truth)이 필요하다. 이전 연구들에서는 기존에 다른 방법을 이용해서 탐지한 데이터를 정답 집합으로 사용하거나, 실험을 위해 사람과 봇 프로그램을 이용해 인위적으로 생성한 데이터를 이용하였다
  - 생태학에서 개체의 규모를 추정하는데 사용하는 capture-recapture 방법과 그래프 분석을 이용하여 이런 문제를 완화하는 기법을 제안
  - 사람이 육안 검사를 통해 게임 봇과 일반 유저를 구분하는 방법을 이용해 정답 집합을 구축
    - 실수나 주관적인 편향에 의해 잘못된 정답 집합을 구축할 수 있기 때문에 이런 문제를 방지하기 위해 아래와 같은 규칙 및 프로세스
      - 첫째, 정답 집합 구축 시 최소 2명 이상의 검사자가 동일한 시간에 동일한 캐릭터에 대해 각각 독립적으로 판정 작업을 진행한 후 결과를 취합
      - 둘째, 게임 봇 판정 시 판정 사유를 기입
      - 정답 집합을 생성한 후에 각각의 판정 대상에 대해서 Leave One Out Cross Validation (LOOCV)을 수행

- 전체 로그 개수와 유저 수에 대한 집계 기준은 일주일이며 한 달 데이터에 대한 평균값을 취했다.
  - 첫째, 특질 데이터를 생성할 때 집계할 데이터 기간과 둘째, 자기 유사도 측정을 위해 사용하는 로그 벡터의 시간 단위
    - 자기 유사도 측정을 위한 로그 벡터를 생성하는 시간 단위는 너무 짧을 경우 하나의 벡터에 담기는 정보량이 너무 적게 되고 반대로 너무 길면 벡터의 개수 자체가 너무 적어서 정밀한 유사도 측정이 어려워진다
    - 300초 ~ 1800초 범위에서 300초 단위로 자기유사도만을 이용하여 탐지 모델을 생성한 후 가장 AUC가 높은 주기를 사용하였다(Fig.7)
    ![image](https://user-images.githubusercontent.com/47103479/146019514-d00189d7-b8fa-4c76-87dd-6fc019a51c92.png)

- Modeling & Evaluation
![image](https://user-images.githubusercontent.com/47103479/146019638-3f1d3b28-e8f1-47e2-a779-97babd8823d4.png)

## 결론
- 게임 서비스를 운영하는 회사 입장에서는 게임 봇 탐지가 일시적인 조치가 아닌 상시적인 운영이 필요한 업무이기 때문에 다양한 게임에 두루 적용할 수 있으면서 적은 유지 보수 비용 만으로 지속적으로 사용
- 탐지 모델을 낮은 비용으로 유지 보수하기 위한 방안으로 EWMA 기반의 탐지 모델 자동 학습 알고리즘을 제안
  - 탐지 모델이 최신 데이터에 적합하지 않게 되는 시점을 감지할 수 있으며 이 시점에 모델을 재학습함으로써 최신 데이터에 맞는 모델 재생성이 가능
